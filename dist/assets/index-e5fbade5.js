import{u as b,r as n,P as h,j as s,c as f,d as v,B as g,a as A,b as y}from"./index-28b8728f.js";import{A as k}from"./index.esm-2e63961d.js";import{s as e,a as w,u as I}from"./styles.module-715ff601.js";import"./index.esm-7458ef39.js";import"./utils-9d128c1d.js";import{B}from"./BackButton-03403362.js";import{D as L}from"./DatePicker-abb74157.js";import{M}from"./Modal-25888893.js";import"./styles.module-4a1edd24.js";import"./styles.module-eea2a584.js";import{S as C,a as D}from"./SidebarItemList-c6ab61ab.js";import{f as R,h as N,d as E}from"./helpers-96bd5b30.js";import{s as O,A as Y}from"./utils-8caaac1e.js";import"./hooks-9171095e.js";import"./useBaseQuery-d5b5de49.js";import"./useQuery-5e80a04e.js";import"./useMutation-267c9319.js";/* empty css               */import"./Typography-37f7fd1d.js";import"./extendSxProp-3260528d.js";import"./Popper-0206d46a.js";import"./lodash-f37d900b.js";import"./Sidebar-c6cdc5c8.js";import"./index.es-b4da052e.js";import"./arrow-bottom-filter-ed2c8b82.js";function F({selectClinic:i}){var t;const c=b(),[l,a]=n.useState(!1),[,r]=n.useState(null);if(!i)return c(h.root),null;const d=()=>{w(i),c(h.superAdmin.editClinic(i.clinic.id))},o=()=>{a(!1)};return s.jsxs("div",{className:f(e.root),children:[s.jsx(B,{title:"",link:h.root}),s.jsxs("div",{className:e.row,children:[s.jsxs("div",{className:e.column,children:[s.jsx("div",{className:e.title,children:i.clinic.name}),s.jsxs("span",{className:e.subTitle,children:["Код клиники: ",i.clinic.id]})]}),s.jsxs("div",{className:e.column,children:[s.jsx("div",{className:e.title,children:"Дата регистрации"}),s.jsx("span",{className:e.subTitle,children:v(i.createdAt).format("DD.MM.YYYY")})]})]}),s.jsxs("div",{className:e.row,children:[s.jsxs("div",{className:e.column,children:[s.jsx("div",{className:e.title,children:"Тип клиники"}),s.jsx("span",{className:e.subTitle,children:(t=i.clinic.type)==null?void 0:t.name})]}),s.jsxs("div",{className:e.column,children:[s.jsx("div",{className:e.title,children:"Телефон"}),s.jsx("span",{className:e.subTitle,children:i.phone})]})]}),s.jsx("div",{className:e.row,children:s.jsxs("div",{className:e.column,children:[s.jsx("div",{className:e.title,children:"Главврач"}),s.jsx("span",{className:e.subTitle,children:i.fullName})]})}),s.jsxs("div",{className:e.row,children:[s.jsxs("div",{className:e.column,children:[s.jsx("div",{className:e.title,children:"Почта"}),s.jsx("span",{className:e.subTitle,children:i.email})]}),s.jsxs("div",{className:e.column,children:[s.jsx("div",{className:e.title,children:"Оплачено до"}),s.jsx("span",{className:e.subTitle,children:s.jsx(L,{defaultValue:v(i.clinic.endPaidDate),onChange:m=>m&&r(m)})})]})]}),s.jsxs("div",{className:e.row,children:[s.jsxs("div",{className:e.column,children:[s.jsx("div",{className:e.title,children:"Адрес"}),s.jsx("span",{className:e.subTitle,children:i.clinic.address})]}),s.jsxs("div",{className:e.column,children:[s.jsx("div",{className:e.title,children:"Город"}),s.jsx("span",{className:e.subTitle,children:i.clinic.city})]})]}),s.jsx("div",{className:e.row,children:i.clinic.description&&s.jsxs("div",{children:[s.jsx("div",{className:e.title,children:"Краткое описание"}),s.jsx("span",{className:e.subTitle,children:i.clinic.description})]})}),s.jsx(g,{color:"secondary",className:e.editButton,onClick:d,children:"Редактировать"}),s.jsxs("div",{className:f(e.row,e.buttonsRemove),children:[s.jsx("button",{type:"button",className:e.remove,children:"Блокировать"}),s.jsx("button",{type:"button",className:e.remove,onClick:()=>a(!0),children:"Удалить клинику"})]}),s.jsx(M,{isOpen:l,onSuccess:o,onClose:()=>a(!1),type:"warn",children:s.jsxs("div",{children:["Вы уверены, что хотите удалить клинику ",s.jsx("br",{}),s.jsxs("span",{className:e.modalNameClinic,children:[i.clinic.name,"?"]})]})})]})}function Q(i,c,l,a,r,d,o,t){return{id:i,createdAt:c,city:l,address:a,phone:r,fullName:d,dateOfBirth:o,status:t}}function U(i){return i!=null&&i.pages.length?i.pages.flatMap(c=>c.map(l=>l.clinic&&Q(l.clinic.id,l.clinic.createdAt,l.clinic.country,l.clinic.address,l.clinic.phone,l.clinic.name,l.clinic.endPaidDate,l.clinic.status))).filter(Boolean):[]}function G(i){return i!=null&&i.pages.length?i.pages.flatMap(c=>c.map(l=>{var a;return l.clinic&&{id:l.clinic.id.toString(),title:l.clinic.name,subTitle:`Код клиники: ${(a=l.clinic)==null?void 0:a.id}`,link:h.superAdmin.selectClinic(l.clinic.id)}})).filter(Boolean):[]}function ps(){const i=A(),[c]=y(),l=b(),{data:a,fetchNextPage:r,updateQueryParameters:d,hasNextPage:o}=I({status:"approval",fieldSort:c.get("fieldSort")}),[t,m]=n.useState(null),p=n.useRef(null),x=n.useRef(null),S=n.useMemo(()=>G(a),[a]),P=n.useMemo(()=>U(a),[a]),T=O(a,Number(i.clinicId));return n.useEffect(()=>{const u=t?R(t):{};d({...u})},[t]),n.useEffect(()=>{N(p,x)()},[i]),s.jsx("div",{className:"super-admin-page",children:s.jsxs("div",{className:"d-flex",children:[s.jsx(C,{ref:p,items:S,selectId:i==null?void 0:i.clinicId,onScroll:N(p,x),children:s.jsx(D,{isSearch:!0,filters:"Все категории",handleChange:u=>{m(j=>({...j,filter:u}))}})}),s.jsx("div",{children:i.clinicId?s.jsx(F,{selectClinic:T}):s.jsx(Y,{ref:x,clinicList:P,hasNextPage:o,handleFetchNextPage:r,handleUpdateFilters:u=>{m(j=>({...j,...u}))},dataLength:E(a),onScroll:N(x,p)})}),s.jsxs(g,{className:"fixed-button",onClick:()=>l(h.superAdmin.addClinic),children:[s.jsx(k,{}),"Добавить клинику"]})]})})}export{ps as default};
