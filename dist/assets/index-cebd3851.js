import{r as h,j as e,B as f,c as N,Q as c,u as E,N as F,P as _,S as B,a as k}from"./index-174441ce.js";import{b as q,c as g,d as A,e as M,f as $,g as H,h as v,i as b,a as T}from"./styles.module-1447fefd.js";import{u as U,E as t,F as i,a as V,b as G}from"./formik.esm-6c75e105.js";import{c as O,a as p}from"./index.esm-62603d67.js";import{e as y}from"./utils-045dd2ef.js";import{p as Q}from"./utils-cdf5c34c.js";import{B as R}from"./BackButton-2c2f05b3.js";/* empty css               */import"./styles.module-eea2a584.js";import"./hooks-23b6f437.js";import"./useBaseQuery-ce99f95b.js";import"./useQuery-b3e65d19.js";import"./useMutation-b7943c53.js";import"./styles.module-4a1edd24.js";function z({userId:a}){const{mutate:o}=q(),[u,n]=h.useState(!1),x=U({name:"password"}),j=async()=>{o({password:x[0].value,userId:a},{onSuccess:({data:s})=>{s.message==="success"&&(c("Success!",{type:"success"}),n(!1))},onError:s=>{c(y(s),{type:"error"})}})};return e.jsxs("div",{children:[!u&&e.jsx(f,{className:N("form-submit"),color:"secondary",onClick:()=>n(!0),children:"Изменить пароль"}),u&&e.jsxs("div",{className:g.editPassword,children:[e.jsxs("fieldset",{children:[e.jsx("div",{className:"error-message",children:e.jsx(t,{name:"password"})}),e.jsx(i,{name:"password",className:"form-input",type:"text",placeholder:"Пароль"})]}),e.jsx(f,{className:N(g.submitPassword,"form-submit"),color:"primary",type:"submit",onClick:j,children:"Применить"})]})]})}function D({clinicId:a,isCreate:o}){var w;const u=E(),{data:n}=A(),{mutate:x}=M(),{mutate:j}=$(),s=H(),S=h.useMemo(()=>{const r={value:-1,label:"Выберите тип клиники"};if(n){const l=n.map(m=>({value:m.name,label:m.name}));return[r,...l]}return[r]},[n]),P=async(r,{setSubmitting:l,resetForm:m})=>{try{!o&&(s!=null&&s.id)?await j({...r,userId:s.id},{onSuccess:d=>{T(d),c("Success!",{type:"success"}),m()},onError:d=>{c(y(d),{type:"error"})}}):"password"in r&&await x(r,{onSuccess:()=>{c("Success!",{type:"success"}),m()},onError:d=>{c(y(d),{type:"error"})}})}finally{l(!1)}};return h.useEffect(()=>(o&&s&&(u(0),v()),function(){v()}),[s,o]),a&&!s?e.jsx(F,{to:_.superAdmin.selectClinic(a)}):e.jsx(V,{initialValues:{email:(s==null?void 0:s.email)??"",fullName:(s==null?void 0:s.fullName)??"",password:"",address:(s==null?void 0:s.clinic.address)??"",country:(s==null?void 0:s.clinic.country)??"",city:(s==null?void 0:s.clinic.city)??"",description:(s==null?void 0:s.clinic.description)??"",name:(s==null?void 0:s.clinic.name)??"",phone:(s==null?void 0:s.phone)??"",type:(w=s==null?void 0:s.clinic.type)==null?void 0:w.name},validationSchema:O().shape({fullName:p().min(3).required(),name:p().min(3).required(),email:p().email().required(),password:Q,type:p().test({name:"type",message:"Selected type",test(r){return!!r}}),phone:p().required()}),onSubmit:(r,l)=>P(r,l),children:({isSubmitting:r})=>e.jsxs(G,{className:b.form,children:[e.jsxs("fieldset",{disabled:r,children:[e.jsxs("fieldset",{className:"full-width",children:[e.jsx("div",{className:"error-message",children:e.jsx(t,{name:"name"})}),e.jsx(i,{name:"name",className:"form-input",type:"text",placeholder:"Название клиники"})]}),e.jsx("fieldset",{className:"full-width",children:e.jsx(i,{name:"type",className:"form-input",placeholder:"Тип клиники",children:l=>{var m;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"error-message",children:(m=l.form.errors)==null?void 0:m.type}),e.jsx(B,{...l,className:"form-input",selectOptions:S})]})}})}),e.jsxs("fieldset",{className:"full-width",children:[e.jsx("div",{className:"error-message",children:e.jsx(t,{name:"address"})}),e.jsx(i,{name:"address",className:"form-input",type:"text",placeholder:"Адрес"})]}),e.jsxs("fieldset",{children:[e.jsx("div",{className:"error-message",children:e.jsx(t,{name:"country"})}),e.jsx(i,{name:"country",className:"form-input",type:"text",placeholder:"Страна"}),e.jsx(t,{name:"country"})]}),e.jsxs("fieldset",{children:[e.jsx("div",{className:"error-message",children:e.jsx(t,{name:"city"})}),e.jsx(i,{name:"city",className:"form-input form-input-text",type:"text",placeholder:"Город"})]}),e.jsxs("fieldset",{children:[e.jsx("div",{className:"error-message",children:e.jsx(t,{name:"phone"})}),e.jsx(i,{name:"phone",className:"form-input",type:"text",placeholder:"+7 (000) - 00 - 00"})]}),e.jsxs("fieldset",{children:[e.jsx("div",{className:"error-message",children:e.jsx(t,{name:"email"})}),e.jsx(i,{name:"email",className:"form-input",type:"text",placeholder:"Почта"})]}),o&&e.jsxs("fieldset",{children:[e.jsx("div",{className:"error-message",children:e.jsx(t,{name:"password"})}),e.jsx(i,{name:"password",className:"form-input",type:"text",placeholder:"Пароль"})]}),e.jsxs("fieldset",{children:[e.jsx("div",{className:"error-message",children:e.jsx(t,{name:"fullName"})}),e.jsx(i,{name:"fullName",className:"form-input",type:"text",placeholder:"Имя главврача"})]}),e.jsxs("fieldset",{className:"full-width",children:[e.jsx("div",{className:"form-textarea-label",children:"Краткое описание"}),e.jsx(i,{name:"description",className:"form-textarea",type:"text",placeholder:"Коментарий...",component:"textarea"}),e.jsx("div",{className:"error-message",children:e.jsx(t,{name:"description"})})]})]}),(s==null?void 0:s.id)&&e.jsx(z,{userId:s.id}),e.jsx(f,{className:N(b.submit,"form-submit"),type:"submit",color:"primary",disabled:r,children:a?"Сохранить":"Создать"})]})})}const J="_root_1no0o_1",K="_formContainer_1no0o_6",C={root:J,formContainer:K};function oe(){const a=k();return e.jsxs("div",{className:C.root,children:[e.jsx(R,{title:a!=null&&a.clinicId?"Редактировать клинику":"Добавить клинику"}),e.jsx("div",{className:C.formContainer,children:e.jsx(D,{clinicId:a!=null&&a.clinicId?Number(a.clinicId):void 0,isCreate:!(a!=null&&a.clinicId)})})]})}export{oe as default};
