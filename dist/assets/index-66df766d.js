import{u as g,r as a,P as h,j as s,d as N,B as y,Q as A,a as S}from"./index-56a4300c.js";import{j as w,k as e,u as M}from"./styles.module-7ed3a975.js";import"./index.esm-e1a6b05d.js";import"./utils-b5269b03.js";import"./styles.module-4a1edd24.js";/* empty css               */import"./styles.module-eea2a584.js";import{e as T}from"./utils-045dd2ef.js";import{B as k}from"./BackButton-cc31f28b.js";import{M as L}from"./Modal-d0336f08.js";import{S as P,a as B}from"./SidebarItemList-0f322045.js";import{f as I,h as f,d as Y}from"./helpers-96bd5b30.js";import{s as E,C as D}from"./utils-5780a07c.js";import"./hooks-2df71e03.js";import"./useBaseQuery-5c054a9d.js";import"./useQuery-c96937ba.js";import"./useMutation-347485be.js";import"./lodash-88c7c6ea.js";import"./Sidebar-e36c1e9a.js";import"./index.es-b1d8489b.js";import"./arrow-bottom-filter-d4e5d5d3.js";function O({selectClinic:i,refetch:n}){var r;const c=g(),{mutate:l}=w(),[o,m]=a.useState({open:!1,type:null});if(!i)return c(h.superAdmin.clinicApplications),null;const t=(d,u)=>{l({id:d,status:u.type==="success"?"approval":"notapproval"},{onSuccess:()=>{m({open:!0,type:u.type})},onError:x=>{A(T(x),{type:"error"})}})},p=()=>{m({open:!1,type:null}),n()};return s.jsxs("div",{className:e.container,children:[s.jsx(k,{title:"",link:h.superAdmin.clinicApplications}),s.jsxs("div",{className:e.row,children:[s.jsxs("div",{className:e.column,children:[s.jsx("div",{className:e.title,children:i.clinic.name}),s.jsxs("span",{className:e.subTitle,children:["Код клиники: ",i.clinic.id]})]}),s.jsxs("div",{className:e.column,children:[s.jsx("div",{className:e.title,children:"Дата регистрации"}),s.jsx("span",{className:e.subTitle,children:N(i.createdAt).format("DD.MM.YYYY")})]})]}),s.jsxs("div",{className:e.row,children:[s.jsxs("div",{className:e.column,children:[s.jsx("div",{className:e.title,children:"Тип клиники"}),s.jsx("span",{className:e.subTitle,children:(r=i.clinic.type)==null?void 0:r.name})]}),s.jsxs("div",{className:e.column,children:[s.jsx("div",{className:e.title,children:"Телефон"}),s.jsx("span",{className:e.subTitle,children:i.phone})]})]}),s.jsx("div",{className:e.row,children:s.jsxs("div",{className:e.column,children:[s.jsx("div",{className:e.title,children:"Главврач"}),s.jsx("span",{className:e.subTitle,children:i.fullName})]})}),s.jsx("div",{className:e.row,children:s.jsxs("div",{className:e.column,children:[s.jsx("div",{className:e.title,children:"Почта"}),s.jsx("span",{className:e.subTitle,children:i.email})]})}),s.jsxs("div",{className:e.row,children:[s.jsxs("div",{className:e.column,children:[s.jsx("div",{className:e.title,children:"Адрес"}),s.jsx("span",{className:e.subTitle,children:i.clinic.address})]}),s.jsxs("div",{className:e.column,children:[s.jsx("div",{className:e.title,children:"Город"}),s.jsx("span",{className:e.subTitle,children:i.clinic.city})]})]}),s.jsx("div",{className:e.row,children:i.clinic.description&&s.jsxs("div",{children:[s.jsx("div",{className:e.title,children:"Краткое описание"}),s.jsx("span",{className:e.subTitle,children:i.clinic.description})]})}),s.jsxs("div",{className:e.row,children:[s.jsx("button",{type:"button",className:e.remove,onClick:()=>t(i.id,{type:"close"}),children:"Отклонить"}),s.jsx(y,{className:e.editButton,onClick:()=>t(i.id,{type:"success"}),children:"Одобрить"})]}),s.jsx(L,{isOpen:o.open,onSuccess:p,onClose:p,type:o.type==="success"?"info":"warn-info",children:s.jsx("div",{children:o.type==="success"?"Заявка одобрена!":"Заявка отклонена"})})]})}function R({id:i,createdAt:n,link:c}){return{id:i,createdAt:n,link:c}}function F(i){return i!=null&&i.pages.length?i.pages.flatMap(n=>n.map(c=>c.clinic&&R({id:c.clinic.id,createdAt:N(c.clinic.createdAt).format("DD.MM.YYYY"),link:`${h.superAdmin.selectApplications(c.clinic.id)}`}))).filter(Boolean):[]}function Q(i){return i!=null&&i.pages.length?i.pages.flatMap(n=>n.map(c=>{var l;return c.clinic&&{id:c.clinic.id.toString(),title:c.clinic.name,subTitle:`Код клиники: ${(l=c.clinic)==null?void 0:l.id}`,link:h.superAdmin.selectApplications(c.clinic.id)}})).filter(Boolean):[]}function ts(){const i=S(),{data:n,hasNextPage:c,refetch:l,updateQueryParameters:o,fetchNextPage:m}=M({status:"pending"}),[t,p]=a.useState(null),r=a.useRef(null),d=a.useRef(null),u=a.useMemo(()=>Q(n),[n]),x=a.useMemo(()=>F(n),[n]),v=E(n,Number(i.clinicId));return a.useEffect(()=>{const j=t?I(t):{};o({...j})},[t]),a.useEffect(()=>{f(r,d)()},[i]),s.jsx("div",{className:"super-admin-page",children:s.jsxs("div",{className:"d-flex",children:[s.jsx(P,{ref:r,items:u,selectId:i.clinicId,children:s.jsx(B,{filters:"Заявки"})}),s.jsx("div",{className:"container",children:i.clinicId?s.jsx(O,{selectClinic:v,refetch:l}):s.jsx(D,{ref:d,hasNextPage:c,handleFetchNextPage:m,handleUpdateFilters:j=>{p(b=>({...b,...j}))},dataLength:Y(n),onScroll:f(d,r),applicationsList:x})})]})})}export{ts as default};
